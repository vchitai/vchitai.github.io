<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Spark RDD | The Barber Theme</title><meta name="description" content="Barber is a blog theme for Jekyll built by Thomas Vaeth for Samesies using HTML, Sass, and JavaScript. "><meta itemprop="name" content="Thomas Vaeth"><meta itemprop="description" content=" - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ "><meta itemprop="image" content="http://barber.samesies.io/assets/images/seo.jpg"><meta property="og:url" content="http://barber.samesies.io/2019/01/05/spark-rdd/"><meta property="og:type" content="website"><meta property="og:title" content="Spark RDD | The Barber Theme"><meta property="og:site_name" content="The Barber Theme"><meta property="og:description" content=" - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ "><meta property="og:image" content="http://barber.samesies.io/assets/images/seo.jpg"><meta name="twitter:url" content="http://barber.samesies.io/2019/01/05/spark-rdd/"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Spark RDD | The Barber Theme"><meta name="twitter:site" content="The Barber Theme"><meta name="twitter:description" content=" - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ "><meta name="twitter:creator" content="@thomasvaeth"><meta property="twitter:image" content="http://barber.samesies.io/assets/images/seo.jpg"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"><link rel="stylesheet" href="/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="The Barber Theme" href="/feed.xml"><link rel="canonical" href="/2019/01/05/spark-rdd/"></head><body id="spark-rdd" class="post-layout"><header class="header"> <a class="header__title" href="http://barber.samesies.io/">The Barber Theme</a><nav><ul class="header__list"><li><a href="/">Stories</a></li><li><a href="/style-guide">Style Guide</a></li><li><span class="popup__open">Contact</span></li></ul></nav></header><main class="üíà"><div class="post"><article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding--double"><div class="grid-small"><h2 itemprop="name headline">Spark RDD</h2><time class="post__date" datetime="2019-01-05T00:00:00+07:00" itemprop="datePublished">5 Jan 2019</time></div></div><div class="post__content section-padding"><div class="grid"><div id="markdown" itemprop="articleBody"><h1 id="low-level-api-c·ªßa-spark">Low-level API c·ªßa Spark</h1><h2 id="ch√∫ng-l√†-g√¨">Ch√∫ng l√† g√¨?</h2><ul><li>bao g·ªìm c√°c Resilient Distributed Dataset (RDDs) c√≥ ch·ª©ng nƒÉng ƒëi·ªÅu khi·ªÉn, s·ª≠ d·ª•ng c√°c d·ªØ li·ªáu ph√¢n t√°n</li><li>C√°c bi·∫øn broadcast v√† c√°c accumulator chuy√™n ph√¢n ph·ªëi v√† x·ª≠ l√Ω c√°c bi·∫øn chia s·∫ª ph√¢n t√°n</li></ul><p><img src="https://lh6.googleusercontent.com/ywMrsDfVaX9G6A6aYRK_HTSu3NJ78ahUAPtr-7B2kUufZ6R5hQ7O0y0R40wru-n6Ula9Q_ONaY-IHptITWxcVairoyvvUWcePVRhFJZp2KbqoUhdPTmxu2BLeCa--HxUc7HMPedZ" alt="alt text" /></p><h2 id="khi-n√†o-n√™n-s·ª≠-d·ª•ng">Khi n√†o n√™n s·ª≠ d·ª•ng?</h2><ul><li>Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster</li><li>Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD</li><li>Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster</li></ul><p><em>Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD</em></p><h2 id="t·∫°i-sao-c·∫ßn-quan-t√¢m-ƒë·∫øn-ch√∫ng">T·∫°i sao c·∫ßn quan t√¢m ƒë·∫øn ch√∫ng?</h2><ul><li>Th·∫≠t s·ª± t·∫•t c·∫£ c√¥ng vi·ªác s·ª≠ d·ª•ng Spark r·ªìi s·∫Ω ƒë∆∞·ª£c bi√™n d·ªãch xu·ªëng th√†nh c√°c th√†nh ph·∫ßn c∆° b·∫£n. C√°c transformation tr√™n DataFrame r·ªìi c≈©ng s·∫Ω ƒë∆∞·ª£c bi√™n d·ªãch th√†nh c√°c transformation tr√™n RDD</li></ul><h2 id="s·ª≠-d·ª•ng-ch√∫ng-nh∆∞-th·∫ø-n√†o">S·ª≠ d·ª•ng ch√∫ng nh∆∞ th·∫ø n√†o?</h2><ul><li>SparkContext s·∫Ω l√† ƒë·∫ßu v√†o c·ªßa c√°c ch·ª©c nƒÉng li√™n quan ƒë·∫øn c√°c API low-level. SparkContext c√≥ th·ªÉ ƒë∆∞·ª£c truy xu·∫•t th√¥ng qua SparkSession - c√¥ng c·ª• m√† ch√∫ng ta s·ª≠ d·ª•ng ƒë·ªÉ th·ª±c hi·ªán t√≠nh to√°n gi·ªØa c√°c cluster c·ªßa Spark.</li></ul><h1 id="v·ªÅ-rdd">V·ªÅ RDD</h1><h2 id="c√°c-lo·∫°i-rdd">C√°c lo·∫°i RDD</h2><p><img src="https://jaceklaskowski.gitbooks.io/mastering-apache-spark/diagrams/spark-rdds.png" alt="alt text" /></p><ul><li>C√°c RDD bi·ªÉu di·ªÖn m·ªôt t·∫≠p h·ª£p c·ªë ƒë·ªãnh, ƒë√£ ƒë∆∞·ª£c ph√¢n v√πng c√°c record ƒë·ªÉ c√≥ th·ªÉ x·ª≠ l√Ω song song</li><li>C√°c record trong RDD c√≥ th·ªÉ l√† ƒë·ªëi t∆∞·ª£ng Java, Scale hay Python t√πy l·∫≠p tr√¨nh vi√™n ch·ªçn. Kh√¥ng gi·ªëng nh∆∞ DataFrame, m·ªói record c·ªßa DataFrame ph·∫£i l√† m·ªôt d√≤ng c√≥ c·∫•u tr√∫c ch·ª©a c√°c field ƒë√£ ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a s·∫µn.</li><li>RDD ƒë√£ t·ª´ng l√† API ch√≠nh ƒë∆∞·ª£c s·ª≠ d·ª•ng trong series Spark 1.x v√† v·∫´n c√≥ th·ªÉ s·ª≠ d·ª•ng trong version 2.X nh∆∞ng kh√¥ng c√≤n ƒë∆∞·ª£c d√πng th∆∞·ªùng xuy√™n n·ªØa</li><li>RDD API c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Python, Scala hay Java<ul><li>Scala v√† Java: Perfomance t∆∞∆°ng ƒë∆∞∆°ng tr√™n h·∫ßu h·∫øt m·ªçi ph·∫ßn. (Chi ph√≠ l·ªõn nh·∫•t l√† khi x·ª≠ l√Ω c√°c raw object)</li><li>Python: M·∫•t m·ªôt l∆∞·ª£ng performance, ch·ªß y·∫øu l√† cho vi·ªác serialization gi·ªØa ti·∫øn tr√¨nh Python v√† JVM</li></ul></li></ul><h2 id="l∆∞u-√Ω-khi-s·ª≠-d·ª•ng-rdd">L∆∞u √Ω khi s·ª≠ d·ª•ng RDD</h2><p><em>V√¨ Spark kh√¥ng nhi·ªÅu c·∫•u tr√∫c n·ªôi h√†m c·ªßa record nh∆∞ c√°c API c√≥ c·∫•u tr√∫c kh√°c n√™n</em></p><ul><li>R·∫•t m·∫°nh nh∆∞ng c≈©ng ti·ªÅm t√†ng nhi·ªÅu nguy c∆°</li><li>C√°c object c√≥ th·ªÉ ch·ª©a b·∫•t k·ª≥ th√¥ng tin g√¨ d∆∞·ªõi b·∫•t k·ª≥ format n√†o</li><li>C√°c c√°ch x·ª≠ l√Ω v√† t∆∞∆°ng t√°c v·ªõi c√°c gi√° tr·ªã ph·∫£i ƒë∆∞·ª£c th·ª±c hi·ªán th·ªß c√¥ng</li><li>Vi·ªác t·ªëi ∆∞u h√≥a y√™u c·∫ßu ph·∫£i l√†m r·∫•t nhi·ªÅu c√¥ng vi·ªác th·ªß c√¥ng</li></ul><h2 id="c√°c-lo·∫°i-rdd-1">C√°c lo·∫°i RDD</h2><ul><li><p>C√≥ r·∫•t nhi·ªÅu l·ªõp con c·ªßa RDD, h·∫ßu h·∫øt ch√∫ng l√† ƒë·ªÉ cho DataFrame c√≥ th·ªÉ t·∫°o v√† t·ªëi ∆∞u h√≥a c√°c execution plan tr√™n t·∫ßng v·∫≠t l√Ω (Xem c√°ch ho·∫°t ƒë·ªông c·ªßa Spark‚Ä¶)</p></li><li><p>Ng∆∞·ªùi d√πng th∆∞·ªùng ch·ªâ s·ª≠ d·ª•ng hai lo·∫°i RDD sau:</p><ul><li>Generic RDD</li><li>Key-value RDD</li></ul></li><li><p>Key-value RDD c√≥ nhi·ªÅu h√†m h·ªó tr·ª£ ƒë·∫∑c bi·ªát c≈©ng nh∆∞ h·ªó tr·ª£ ph√¢n ho·∫°ch custom b·∫±ng key</p></li></ul><h2 id="thu·ªôc-t√≠nh-c·ªßa-rdd">Thu·ªôc t√≠nh c·ªßa RDD</h2><p>B·∫Øt bu·ªôc:</p><ul><li>M·ªôt danh s√°ch c√°c partitions</li><li>M·ªôt h√†m ƒë·ªÉ t√≠nh to√°n c√°c split</li><li>M·ªôt danh s√°ch dependencies v·ªõi RDD kh√°c</li></ul><p>Kh√¥ng b·∫Øt bu·ªôc:</p><ul><li>M·ªôt partitioner ƒë·ªëi v·ªõi RDD key-value (Trong tr∆∞·ªùng h·ª£p RDD ƒë∆∞·ª£c hash-partitioned)</li><li>M·ªôt danh s√°ch c√°c v·ªã tr√≠ l∆∞u tr·ªØ ƒë·ªÉ t√≠nh to√°n c√°c split (V√≠ d·ª• nh∆∞ c√°c block c·ªßa HDFS)</li></ul><h2 id="t·∫°o-m·ªôt-rdd">T·∫°o m·ªôt RDD</h2><ul><li>C√°ch ƒë∆°n gi·∫£n nh·∫•t: T·∫°o t·ª´ m·ªôt DataFrame hay Dataset<ul><li>Java hay Scala: T·ª´ Dataset[T] c√≥ th·ªÉ chuy·ªÉn qua RDD[T]</li><li>Python: Ch·ªâ c√≥ th·ªÉ chuy·ªÉn t·ª´ DataFrame[Row] sang RDD[Row] ƒê·ªìng th·ªùi ta c≈©ng c√≥ th·ªÉ chuy·ªÉn ƒë·ªïi theo chi·ªÅu ng∆∞·ª£c l·∫°i</li></ul></li><li>T·∫°o t·ª´ m·ªôt Local Collection: S·ª≠ d·ª•ng h√†m parallelize tr√™n SparkContext ƒë·ªÉ chuy·ªÉn m·ªôt collection single node sang m·ªôt collection parallel</li><li>T·∫°o t·ª´ c√°c Data Source: RDD kh√¥ng c√≥ kh√°i ni·ªám ‚ÄúData Source APIs‚Äù v√¨ ch√∫ng ch·ªß y·∫øu define c√°c c·∫•u tr√∫c dependencies gi·ªØa c√°c partition. Ta c√≥ th·ªÉ t·∫°o m·ªôt RDD v·ªõi m·ªói d√≤ng c·ªßa text file l√† m·ªôt record hay c·∫£ text file l√† m·ªôt record duy nh·∫•t.</li></ul><h1 id="c√°c-transformation-v√†-action-v·ªõi-rdd">C√°c transformation v√† action v·ªõi RDD</h1><p>RDD cung c·∫•p c√°c transformation v√† action ho·∫°t ƒë·ªông gi·ªëng nh∆∞ DataFrame l·∫´n DataSets. Transformation x·ª≠ l√Ω c√°c thao t√°c lazily v√† action x·ª≠ l√Ω thao t√°c ngay.</p><p><img src="https://image.slidesharecdn.com/11-150526111122-lva1-app6891/95/11-from-hadoop-to-spark-12-43-638.jpg?cb=1433608610" alt="" /></p><h2 id="m·ªôt-s·ªë-transformation">M·ªôt s·ªë transformation</h2><p><em>Nhi·ªÅu phi√™n b·∫£n transformation c·ªßa RDD c√≥ th·ªÉ ho·∫°t ƒë·ªông tr√™n c√°c Structured API, transformation x·ª≠ l√Ω lazily, t·ª©c l√† ch·ªâ gi√∫p d·ª±ng execution plans, d·ªØ li·ªáu ch·ªâ ƒë∆∞·ª£c truy xu·∫•t th·ª±c s·ª± khi th·ª±c hi·ªán action</em></p><ul><li>distinct: lo·∫°i b·ªè tr√πng l·∫Øp trong RDD</li><li>filter: t∆∞∆°ng ƒë∆∞∆°ng v·ªõi vi·ªác s·ª≠ d·ª•ng where trong SQL - t√¨m c√°c record trong RDD xem nh·ªØng ph·∫ßn t·ª≠ n√†o th·ªèa ƒëi·ªÅu ki·ªán. C√≥ th·ªÉ cung c·∫•p m·ªôt h√†m ph·ª©c t·∫°p s·ª≠ d·ª•ng ƒë·ªÉ filter c√°c record c·∫ßn thi·∫øt - Nh∆∞ trong Python, ta c√≥ th·ªÉ s·ª≠ d·ª•ng h√†m lambda ƒë·ªÉ truy·ªÅn v√†o filter</li><li>map: th·ª±c hi·ªán m·ªôt c√¥ng vi·ªác n√†o ƒë√≥ tr√™n to√†n b·ªô RDD. Trong Python s·ª≠ d·ª•ng lambda v·ªõi t·ª´ng ph·∫ßn t·ª≠ ƒë·ªÉ truy·ªÅn v√†o map</li><li>flatMap: cung c·∫•p m·ªôt h√†m ƒë∆°n gi·∫£n h∆°n h√†m map. Y√™u c·∫ßu output c·ªßa map ph·∫£i l√† m·ªôt structure c√≥ th·ªÉ l·∫∑p v√† m·ªü r·ªông ƒë∆∞·ª£c.</li><li>sortBy: m√¥ t·∫£ m·ªôt h√†m ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ c√°c object c·ªßa RDD v√† th·ª±c hi·ªán sort ƒë∆∞·ª£c t·ª´ ƒë√≥.</li><li>randomSplit: nh·∫≠n m·ªôt m·∫£ng tr·ªçng s·ªë v√† t·∫°o m·ªôt random seed, t√°ch c√°c RDD th√†nh m·ªôt m·∫£ng c√°c RDD c√≥ s·ªë l∆∞·ª£ng chia theo tr·ªçng s·ªë.</li></ul><h2 id="m·ªôt-s·ªë-action">M·ªôt s·ªë action</h2><p><em>Action th·ª±c thi ngay c√°c transformation ƒë√£ ƒë∆∞·ª£c thi·∫øt l·∫≠p ƒë·ªÉ thu th·∫≠p d·ªØ li·ªáu v·ªÅ driver ƒë·ªÉ x·ª≠ l√Ω ho·∫∑c ghi d·ªØ li·ªáu xu·ªëng c√°c c√¥ng c·ª• l∆∞u tr·ªØ</em></p><ul><li>reduce: th·ª±c hi·ªán h√†m reduce tr√™n RDD ƒë·ªÉ thu v·ªÅ 1 gi√° tr·ªã duy nh·∫•t</li><li>count: ƒë·∫øm s·ªë d√≤ng trong RDD</li><li>countApprox: phi√™n b·∫£n ƒë·∫øm x·∫•p x·ªâ c·ªßa count, nh∆∞ng ph·∫£i cung c·∫•p timeout v√¨ c√≥ th·ªÉ kh√¥ng nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£.</li><li>countByValue: ƒë·∫øm s·ªë gi√° tr·ªã c·ªßa RDD<ul><li>ch·ªâ s·ª≠ d·ª•ng n·∫øu map k·∫øt qu·∫£ nh·ªè v√¨ t·∫•t c·∫£ d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c load l√™n memory c·ªßa driver ƒë·ªÉ t√≠nh to√°n</li><li>ch·ªâ n√™n s·ª≠ d·ª•ng trong t√¨nh hu·ªëng s·ªë d√≤ng nh·ªè v√† s·ªë l∆∞·ª£ng item kh√°c nhau c≈©ng nh·ªè.</li></ul></li><li>countApproxDistinct: ƒë·∫øm x·∫•p x·ªâ c√°c gi√° tr·ªã kh√°c nhau</li><li>countByValueApprox: ƒë·∫øm x·∫•p x·ªâ c√°c gi√° tr·ªã</li><li>first: l·∫•y gi√° tr·ªã ƒë·∫ßu ti√™n c·ªßa dataset</li><li>max v√† min: l·∫ßn l∆∞·ª£t l·∫•y gi√° tr·ªã l·ªõn nh·∫•t v√† nh·ªè nh·∫•t c·ªßa dataset</li><li>take v√† c√°c method t∆∞∆°ng t·ª±: l·∫•y m·ªôt l∆∞·ª£ng gi√° tr·ªã t·ª´ trong RDD. take s·∫Ω tr∆∞·ªõc h·∫øt scan qua m·ªôt partition v√† s·ª≠ d·ª•ng k·∫øt qu·∫£ ƒë·ªÉ d·ª± ƒëo√°n s·ªë l∆∞·ª£ng partition c·∫ßn ph·∫£i l·∫•y th√™m ƒë·ªÉ th·ªèa m√£n s·ªë l∆∞·ª£ng l·∫•y.</li><li>top v√† takeOrdered: top s·∫Ω hi·ªáu qu·∫£ h∆°n takeOrdered v√¨ top l·∫•y c√°c gi√° tr·ªã ƒë·∫ßu ti√™n ƒë∆∞·ª£c s·∫Øp x·∫øp ng·∫ßm trong RDD.</li><li>takeSamples: l·∫•y m·ªôt l∆∞·ª£ng gi√° tr·ªã ng·∫´u nhi√™n trong RDD</li></ul><h2 id="m·ªôt-s·ªë-k·ªπ-thu·∫≠t-n√¢ng-cao-ƒë·ªëi-v·ªõi-rdd">M·ªôt s·ªë k·ªπ thu·∫≠t n√¢ng cao ƒë·ªëi v·ªõi RDD:</h2><h3 id="l∆∞u-tr·ªØ-file">L∆∞u tr·ªØ file</h3><ul><li>L∆∞u tr·ªØ file c√≥ nghƒ©a l√† ghi v√†o c√°c file plain-text</li><li>C√≥ th·ªÉ s·ª≠ d·ª•ng c√°c codec n√©n t·ª´ th∆∞ vi·ªán c·ªßa Hadoop</li><li>L∆∞u tr·ªØ v√†o c√°c database b√™n ngo√†i y√™u c·∫ßu ta ph·∫£i l·∫∑p qua t·∫•t c·∫£ partition c·ªßa RDD - C√¥ng vi·ªác ƒë∆∞·ª£c th·ª±c hi·ªán ng·∫ßm trong c√°c high-level API</li><li>sequenceFile l√† m·ªôt flat file ch·ª©a c√°c c·∫∑p key-value, th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng l√†m ƒë·ªãnh d·∫°ng input/output c·ªßa MapReduce. Spark c√≥ th·ªÉ ghi c√°c sequenceFile b·∫±ng c√°c ghi l·∫°i c√°c c·∫∑p key-value</li><li>ƒê·ªìng th·ªùi, Spark c≈©ng h·ªó tr·ª£ ghi nhi·ªÅu ƒë·ªãnh d·∫°ng file kh√°c nhau, cho ph√©p define c√°c class, ƒë·ªãnh d·∫°ng output, config v√† compression scheme c·ªßa Hadoop.</li></ul><h3 id="caching---tƒÉng-t·ªëc-x·ª≠-l√Ω-b·∫±ng-cache">Caching - tƒÉng t·ªëc x·ª≠ l√Ω b·∫±ng cache</h3><ul><li>Caching v·ªõi RDD, Dataset hay DataFrame c√≥ nguy√™n l√Ω nh∆∞ nhau.</li><li>Ch√∫ng ta c√≥ th·ªÉ l·ª±a ch·ªçn cache hay persist m·ªôt RDD, v√† m·∫∑c ƒë·ªãnh, ch·ªâ x·ª≠ l√Ω d·ªØ li·ªáu trong b·ªô nh·ªõ</li></ul><h3 id="checkpointing---l∆∞u-tr·ªØ-l·∫°i-c√°c-b∆∞·ªõc-x·ª≠-l√Ω-ƒë·ªÉ-ph·ª•c-h·ªìi">Checkpointing - l∆∞u tr·ªØ l·∫°i c√°c b∆∞·ªõc x·ª≠ l√Ω ƒë·ªÉ ph·ª•c h·ªìi</h3><ul><li>Checkpointing l∆∞u RDD v√†o ƒëƒ©a c·ª©ng ƒë·ªÉ c√°c ti·∫øn tr√¨nh kh√°c ƒë·ªÉ th·ªÉ s·ª≠ d·ª•ng l·∫°i RDD point n√†y l√†m partition trung gian thay v√¨ t√≠nh to√°n l·∫°i RDD t·ª´ c√°c ngu·ªìn d·ªØ li·ªáu g·ªëc</li><li>Checkpointing c≈©ng t∆∞∆°ng t·ª± nh∆∞ cache, ch·ªâ kh√°c nhau l√† l∆∞u tr·ªØ v√†o ƒëƒ©a c·ª©ng v√† kh√¥ng d√πng ƒë∆∞·ª£c trong API c·ªßa DataFrame</li><li>Ch√∫ng ta s·∫Ω c·∫ßn s·ª≠ d·ª•ng nhi·ªÅu ƒë·ªÉ t·ªëi ∆∞u t√≠nh to√°n.</li></ul></div><ul class="post__social"><li><a href="https://www.facebook.com/sharer/sharer.php?u=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="https://twitter.com/intent/tweet?&text=Spark RDD+http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://plus.google.com/share?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-google-plus"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&source=Spark RDD&summary= - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ &url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://www.stumbleupon.com/badge/?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-stumbleupon"></i></a></li><li><a href="https://www.reddit.com/submit?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li><li><a href="https://www.tumblr.com/share/link?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-tumblr"></i></a></li><li><a href="https://www.pinterest.com/pin/create/link/?description= - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ - Khi ch√∫ng ta c·∫ßn ph·∫£i x·ª≠ l√Ω c√°c ch·ª©c nƒÉng kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c trong c√°c API high-level Vd: c·∫ßn x·ª≠ l√Ω d·ªØ li·ªáu ·ªü t·∫ßng v·∫≠t l√Ω - ch·ªß ƒë·ªông ph√¢n ph·ªëi d·ªØ li·ªáu gi·ªØa c√°c cluster - Ch·ªânh s·ª≠a m·ªôt s·ªë codebase t·∫ßng th·∫•p vi·∫øt b·∫±ng RDD - Th·ª±c hi·ªán m·ªôt s·ªë c√¥ng vi·ªác y√™u c·∫ßu s·ª≠ d·ª•ng c√°c bi·∫øn chia s·∫ª custom gi·ªØa c√°c cluster _Trong ƒëa s·ªë tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng DataFrame s·∫Ω hi·ªáu qu·∫£ h∆°n, ·ªïn ƒë·ªãnh h∆°n nh∆∞ng c≈©ng t·ªën k√©m h∆°n so v·ªõi RDD_ &media=&url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-pinterest"></i></a></li></ul></div></div></article></div></main><footer class="footer section-padding"><div class="grid"><div class="subscribe" id="subscribe"><div class="subscribe__container"> <span class="subscribe__title">Subscribe</span><p class="subscribe__text">Get a weekly email of posts I‚Äôve added to the site.</p><form method="POST" action="https://samesies.us17.list-manage.com/subscribe/post-json?u=66ddf555dab480e6a8606430b&amp;id=89b3ee034f&amp;c=?" id="mc-signup" name="mc-embedded-subscribe-form" novalidate><div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_66ddf555dab480e6a8606430b_89b3ee034f" tabindex="-1" value=""></div><div class="form-group"> <input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Email Address"></div><div class="form__btn"> <input id="mc-submit" type="submit" value="Sign Up" name="subscribe"></div></form><p class="subscribe__error hidden"></p></div></div><hr class="sep--white"/><div class="footer__container"><ul class="footer__tags"><li><a class="footer__link" href="/tag/kale">Kale</a></li><li><a class="footer__link" href="/tag/moon-drinking">Moon Drinking</a></li><li><a class="footer__link" href="/tag/squid">Squid</a></li><li><a class="footer__link" href="/tag/mixtape">Mixtape</a></li><li><a class="footer__link" href="/tag/dummy-text">Dummy Text</a></li></ul><ul class="footer__social"><li><a href="https://twitter.com/thomasvaeth" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.instagram.com/thomas.vaeth/" target="_blank"><i class="fa fa-instagram"></i></a></li><li><a href="https://www.linkedin.com/in/thomasvaeth/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://github.com/samesies" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="https://codepen.io/thomasvaeth/" target="_blank"><i class="fa fa-codepen"></i></a></li></ul></div></div></footer><section class="contact popup"><div class="popup__close"><div class="popup__exit"></div></div><div class="contact__container popup__container"><div class="contact__img"><figure class="absolute-bg" style="background-image: url(/assets/images/placeholder-28.jpg);"></figure></div><div class="contact__content"><div class="contact__mast section-padding--half"><div class="grid"><h2>Contact</h2></div></div><div class="section-padding--none"><hr class="sep"/></div><div class="contact__form section-padding--half"><div class="grid-xlarge"> <form id="form" class="form" action="https://formcarry.com/s/HkIo0nMb7" method="POST"><div class="form__subcontainer"><div> <label for="form-first-name">First Name</label> <input type="text" name="first-name" id="form-first-name" required></div><div> <label for="form-last-name">Last Name</label> <input type="text" name="last-name" id="form-last-name" required></div></div><div> <label for="form-email">E-Mail</label> <input type="email" name="email" id="form-email" required></div><div> <label for="form-message">Message</label> <textarea name="message" id="form-message" rows="3"></textarea></div><div class="form__submit"><div class="form__btn"> <input type="submit" value="Send"></div></div><p class="form__message"></p></form></div></div></div></div></section><script src="/assets/js/app.min.js"></script></body></html>
  