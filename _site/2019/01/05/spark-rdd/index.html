<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Spark RDD | The Barber Theme</title><meta name="description" content="Barber is a blog theme for Jekyll built by Thomas Vaeth for Samesies using HTML, Sass, and JavaScript. "><meta itemprop="name" content="Thomas Vaeth"><meta itemprop="description" content=" - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ "><meta itemprop="image" content="http://barber.samesies.io/assets/images/seo.jpg"><meta property="og:url" content="http://barber.samesies.io/2019/01/05/spark-rdd/"><meta property="og:type" content="website"><meta property="og:title" content="Spark RDD | The Barber Theme"><meta property="og:site_name" content="The Barber Theme"><meta property="og:description" content=" - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ "><meta property="og:image" content="http://barber.samesies.io/assets/images/seo.jpg"><meta name="twitter:url" content="http://barber.samesies.io/2019/01/05/spark-rdd/"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Spark RDD | The Barber Theme"><meta name="twitter:site" content="The Barber Theme"><meta name="twitter:description" content=" - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ "><meta name="twitter:creator" content="@thomasvaeth"><meta property="twitter:image" content="http://barber.samesies.io/assets/images/seo.jpg"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"><link rel="stylesheet" href="/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="The Barber Theme" href="/feed.xml"><link rel="canonical" href="/2019/01/05/spark-rdd/"></head><body id="spark-rdd" class="post-layout"><header class="header"> <a class="header__title" href="http://barber.samesies.io/">The Barber Theme</a><nav><ul class="header__list"><li><a href="/">Stories</a></li><li><a href="/style-guide">Style Guide</a></li><li><span class="popup__open">Contact</span></li></ul></nav></header><main class="ğŸ’ˆ"><div class="post"><article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding--double"><div class="grid-small"><h2 itemprop="name headline">Spark RDD</h2><time class="post__date" datetime="2019-01-05T00:00:00+07:00" itemprop="datePublished">5 Jan 2019</time></div></div><div class="post__content section-padding"><div class="grid"><div id="markdown" itemprop="articleBody"><h1 id="low-level-api-cá»§a-spark">Low-level API cá»§a Spark</h1><h2 id="chÃºng-lÃ -gÃ¬">ChÃºng lÃ  gÃ¬?</h2><ul><li>bao gá»“m cÃ¡c Resilient Distributed Dataset (RDDs) cÃ³ chá»©ng nÄƒng Ä‘iá»u khiá»ƒn, sá»­ dá»¥ng cÃ¡c dá»¯ liá»‡u phÃ¢n tÃ¡n</li><li>CÃ¡c biáº¿n broadcast vÃ  cÃ¡c accumulator chuyÃªn phÃ¢n phá»‘i vÃ  xá»­ lÃ½ cÃ¡c biáº¿n chia sáº» phÃ¢n tÃ¡n</li></ul><p><img src="https://lh6.googleusercontent.com/ywMrsDfVaX9G6A6aYRK_HTSu3NJ78ahUAPtr-7B2kUufZ6R5hQ7O0y0R40wru-n6Ula9Q_ONaY-IHptITWxcVairoyvvUWcePVRhFJZp2KbqoUhdPTmxu2BLeCa--HxUc7HMPedZ" alt="alt text" /></p><h2 id="khi-nÃ o-nÃªn-sá»­-dá»¥ng">Khi nÃ o nÃªn sá»­ dá»¥ng?</h2><ul><li>Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster</li><li>Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD</li><li>Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster</li></ul><p><em>Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD</em></p><h2 id="táº¡i-sao-cáº§n-quan-tÃ¢m-Ä‘áº¿n-chÃºng">Táº¡i sao cáº§n quan tÃ¢m Ä‘áº¿n chÃºng?</h2><ul><li>Tháº­t sá»± táº¥t cáº£ cÃ´ng viá»‡c sá»­ dá»¥ng Spark rá»“i sáº½ Ä‘Æ°á»£c biÃªn dá»‹ch xuá»‘ng thÃ nh cÃ¡c thÃ nh pháº§n cÆ¡ báº£n. CÃ¡c transformation trÃªn DataFrame rá»“i cÅ©ng sáº½ Ä‘Æ°á»£c biÃªn dá»‹ch thÃ nh cÃ¡c transformation trÃªn RDD</li></ul><h2 id="sá»­-dá»¥ng-chÃºng-nhÆ°-tháº¿-nÃ o">Sá»­ dá»¥ng chÃºng nhÆ° tháº¿ nÃ o?</h2><ul><li>SparkContext sáº½ lÃ  Ä‘áº§u vÃ o cá»§a cÃ¡c chá»©c nÄƒng liÃªn quan Ä‘áº¿n cÃ¡c API low-level. SparkContext cÃ³ thá»ƒ Ä‘Æ°á»£c truy xuáº¥t thÃ´ng qua SparkSession - cÃ´ng cá»¥ mÃ  chÃºng ta sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n tÃ­nh toÃ¡n giá»¯a cÃ¡c cluster cá»§a Spark.</li></ul><h1 id="vá»-rdd">Vá» RDD</h1><h2 id="cÃ¡c-loáº¡i-rdd">CÃ¡c loáº¡i RDD</h2><p><img src="https://jaceklaskowski.gitbooks.io/mastering-apache-spark/diagrams/spark-rdds.png" alt="alt text" /></p><ul><li>CÃ¡c RDD biá»ƒu diá»…n má»™t táº­p há»£p cá»‘ Ä‘á»‹nh, Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n vÃ¹ng cÃ¡c record Ä‘á»ƒ cÃ³ thá»ƒ xá»­ lÃ½ song song</li><li>CÃ¡c record trong RDD cÃ³ thá»ƒ lÃ  Ä‘á»‘i tÆ°á»£ng Java, Scale hay Python tÃ¹y láº­p trÃ¬nh viÃªn chá»n. KhÃ´ng giá»‘ng nhÆ° DataFrame, má»—i record cá»§a DataFrame pháº£i lÃ  má»™t dÃ²ng cÃ³ cáº¥u trÃºc chá»©a cÃ¡c field Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a sáºµn.</li><li>RDD Ä‘Ã£ tá»«ng lÃ  API chÃ­nh Ä‘Æ°á»£c sá»­ dá»¥ng trong series Spark 1.x vÃ  váº«n cÃ³ thá»ƒ sá»­ dá»¥ng trong version 2.X nhÆ°ng khÃ´ng cÃ²n Ä‘Æ°á»£c dÃ¹ng thÆ°á»ng xuyÃªn ná»¯a</li><li>RDD API cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong Python, Scala hay Java<ul><li>Scala vÃ  Java: Perfomance tÆ°Æ¡ng Ä‘Æ°Æ¡ng trÃªn háº§u háº¿t má»i pháº§n. (Chi phÃ­ lá»›n nháº¥t lÃ  khi xá»­ lÃ½ cÃ¡c raw object)</li><li>Python: Máº¥t má»™t lÆ°á»£ng performance, chá»§ yáº¿u lÃ  cho viá»‡c serialization giá»¯a tiáº¿n trÃ¬nh Python vÃ  JVM</li></ul></li></ul><h2 id="lÆ°u-Ã½-khi-sá»­-dá»¥ng-rdd">LÆ°u Ã½ khi sá»­ dá»¥ng RDD</h2><p><em>VÃ¬ Spark khÃ´ng nhiá»u cáº¥u trÃºc ná»™i hÃ m cá»§a record nhÆ° cÃ¡c API cÃ³ cáº¥u trÃºc khÃ¡c nÃªn</em></p><ul><li>Ráº¥t máº¡nh nhÆ°ng cÅ©ng tiá»m tÃ ng nhiá»u nguy cÆ¡</li><li>CÃ¡c object cÃ³ thá»ƒ chá»©a báº¥t ká»³ thÃ´ng tin gÃ¬ dÆ°á»›i báº¥t ká»³ format nÃ o</li><li>CÃ¡c cÃ¡ch xá»­ lÃ½ vÃ  tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c giÃ¡ trá»‹ pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n thá»§ cÃ´ng</li><li>Viá»‡c tá»‘i Æ°u hÃ³a yÃªu cáº§u pháº£i lÃ m ráº¥t nhiá»u cÃ´ng viá»‡c thá»§ cÃ´ng</li></ul><h2 id="cÃ¡c-loáº¡i-rdd-1">CÃ¡c loáº¡i RDD</h2><ul><li><p>CÃ³ ráº¥t nhiá»u lá»›p con cá»§a RDD, háº§u háº¿t chÃºng lÃ  Ä‘á»ƒ cho DataFrame cÃ³ thá»ƒ táº¡o vÃ  tá»‘i Æ°u hÃ³a cÃ¡c execution plan trÃªn táº§ng váº­t lÃ½ (Xem cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Sparkâ€¦)</p></li><li><p>NgÆ°á»i dÃ¹ng thÆ°á»ng chá»‰ sá»­ dá»¥ng hai loáº¡i RDD sau:</p><ul><li>Generic RDD</li><li>Key-value RDD</li></ul></li><li><p>Key-value RDD cÃ³ nhiá»u hÃ m há»— trá»£ Ä‘áº·c biá»‡t cÅ©ng nhÆ° há»— trá»£ phÃ¢n hoáº¡ch custom báº±ng key</p></li></ul><h2 id="thuá»™c-tÃ­nh-cá»§a-rdd">Thuá»™c tÃ­nh cá»§a RDD</h2><p>Báº¯t buá»™c:</p><ul><li>Má»™t danh sÃ¡ch cÃ¡c partitions</li><li>Má»™t hÃ m Ä‘á»ƒ tÃ­nh toÃ¡n cÃ¡c split</li><li>Má»™t danh sÃ¡ch dependencies vá»›i RDD khÃ¡c</li></ul><p>KhÃ´ng báº¯t buá»™c:</p><ul><li>Má»™t partitioner Ä‘á»‘i vá»›i RDD key-value (Trong trÆ°á»ng há»£p RDD Ä‘Æ°á»£c hash-partitioned)</li><li>Má»™t danh sÃ¡ch cÃ¡c vá»‹ trÃ­ lÆ°u trá»¯ Ä‘á»ƒ tÃ­nh toÃ¡n cÃ¡c split (VÃ­ dá»¥ nhÆ° cÃ¡c block cá»§a HDFS)</li></ul><h2 id="táº¡o-má»™t-rdd">Táº¡o má»™t RDD</h2><ul><li>CÃ¡ch Ä‘Æ¡n giáº£n nháº¥t: Táº¡o tá»« má»™t DataFrame hay Dataset<ul><li>Java hay Scala: Tá»« Dataset[T] cÃ³ thá»ƒ chuyá»ƒn qua RDD[T]</li><li>Python: Chá»‰ cÃ³ thá»ƒ chuyá»ƒn tá»« DataFrame[Row] sang RDD[Row] Äá»“ng thá»i ta cÅ©ng cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i theo chiá»u ngÆ°á»£c láº¡i</li></ul></li><li>Táº¡o tá»« má»™t Local Collection: Sá»­ dá»¥ng hÃ m parallelize trÃªn SparkContext Ä‘á»ƒ chuyá»ƒn má»™t collection single node sang má»™t collection parallel</li><li>Táº¡o tá»« cÃ¡c Data Source: RDD khÃ´ng cÃ³ khÃ¡i niá»‡m â€œData Source APIsâ€ vÃ¬ chÃºng chá»§ yáº¿u define cÃ¡c cáº¥u trÃºc dependencies giá»¯a cÃ¡c partition. Ta cÃ³ thá»ƒ táº¡o má»™t RDD vá»›i má»—i dÃ²ng cá»§a text file lÃ  má»™t record hay cáº£ text file lÃ  má»™t record duy nháº¥t.</li></ul><h1 id="cÃ¡c-transformation-vÃ -action-vá»›i-rdd">CÃ¡c transformation vÃ  action vá»›i RDD</h1><p>RDD cung cáº¥p cÃ¡c transformation vÃ  action hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° DataFrame láº«n DataSets. Transformation xá»­ lÃ½ cÃ¡c thao tÃ¡c lazily vÃ  action xá»­ lÃ½ thao tÃ¡c ngay.</p><p><img src="https://image.slidesharecdn.com/11-150526111122-lva1-app6891/95/11-from-hadoop-to-spark-12-43-638.jpg?cb=1433608610" alt="" /></p><h2 id="má»™t-sá»‘-transformation">Má»™t sá»‘ transformation</h2><p><em>Nhiá»u phiÃªn báº£n transformation cá»§a RDD cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng trÃªn cÃ¡c Structured API, transformation xá»­ lÃ½ lazily, tá»©c lÃ  chá»‰ giÃºp dá»±ng execution plans, dá»¯ liá»‡u chá»‰ Ä‘Æ°á»£c truy xuáº¥t thá»±c sá»± khi thá»±c hiá»‡n action</em></p><ul><li>distinct: loáº¡i bá» trÃ¹ng láº¯p trong RDD</li><li>filter: tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c sá»­ dá»¥ng where trong SQL - tÃ¬m cÃ¡c record trong RDD xem nhá»¯ng pháº§n tá»­ nÃ o thá»a Ä‘iá»u kiá»‡n. CÃ³ thá»ƒ cung cáº¥p má»™t hÃ m phá»©c táº¡p sá»­ dá»¥ng Ä‘á»ƒ filter cÃ¡c record cáº§n thiáº¿t - NhÆ° trong Python, ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m lambda Ä‘á»ƒ truyá»n vÃ o filter</li><li>map: thá»±c hiá»‡n má»™t cÃ´ng viá»‡c nÃ o Ä‘Ã³ trÃªn toÃ n bá»™ RDD. Trong Python sá»­ dá»¥ng lambda vá»›i tá»«ng pháº§n tá»­ Ä‘á»ƒ truyá»n vÃ o map</li><li>flatMap: cung cáº¥p má»™t hÃ m Ä‘Æ¡n giáº£n hÆ¡n hÃ m map. YÃªu cáº§u output cá»§a map pháº£i lÃ  má»™t structure cÃ³ thá»ƒ láº·p vÃ  má»Ÿ rá»™ng Ä‘Æ°á»£c.</li><li>sortBy: mÃ´ táº£ má»™t hÃ m Ä‘á»ƒ trÃ­ch xuáº¥t dá»¯ liá»‡u tá»« cÃ¡c object cá»§a RDD vÃ  thá»±c hiá»‡n sort Ä‘Æ°á»£c tá»« Ä‘Ã³.</li><li>randomSplit: nháº­n má»™t máº£ng trá»ng sá»‘ vÃ  táº¡o má»™t random seed, tÃ¡ch cÃ¡c RDD thÃ nh má»™t máº£ng cÃ¡c RDD cÃ³ sá»‘ lÆ°á»£ng chia theo trá»ng sá»‘.</li></ul><h2 id="má»™t-sá»‘-action">Má»™t sá»‘ action</h2><p><em>Action thá»±c thi ngay cÃ¡c transformation Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p Ä‘á»ƒ thu tháº­p dá»¯ liá»‡u vá» driver Ä‘á»ƒ xá»­ lÃ½ hoáº·c ghi dá»¯ liá»‡u xuá»‘ng cÃ¡c cÃ´ng cá»¥ lÆ°u trá»¯</em></p><ul><li>reduce: thá»±c hiá»‡n hÃ m reduce trÃªn RDD Ä‘á»ƒ thu vá» 1 giÃ¡ trá»‹ duy nháº¥t</li><li>count: Ä‘áº¿m sá»‘ dÃ²ng trong RDD</li><li>countApprox: phiÃªn báº£n Ä‘áº¿m xáº¥p xá»‰ cá»§a count, nhÆ°ng pháº£i cung cáº¥p timeout vÃ¬ cÃ³ thá»ƒ khÃ´ng nháº­n Ä‘Æ°á»£c káº¿t quáº£.</li><li>countByValue: Ä‘áº¿m sá»‘ giÃ¡ trá»‹ cá»§a RDD<ul><li>chá»‰ sá»­ dá»¥ng náº¿u map káº¿t quáº£ nhá» vÃ¬ táº¥t cáº£ dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c load lÃªn memory cá»§a driver Ä‘á»ƒ tÃ­nh toÃ¡n</li><li>chá»‰ nÃªn sá»­ dá»¥ng trong tÃ¬nh huá»‘ng sá»‘ dÃ²ng nhá» vÃ  sá»‘ lÆ°á»£ng item khÃ¡c nhau cÅ©ng nhá».</li></ul></li><li>countApproxDistinct: Ä‘áº¿m xáº¥p xá»‰ cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau</li><li>countByValueApprox: Ä‘áº¿m xáº¥p xá»‰ cÃ¡c giÃ¡ trá»‹</li><li>first: láº¥y giÃ¡ trá»‹ Ä‘áº§u tiÃªn cá»§a dataset</li><li>max vÃ  min: láº§n lÆ°á»£t láº¥y giÃ¡ trá»‹ lá»›n nháº¥t vÃ  nhá» nháº¥t cá»§a dataset</li><li>take vÃ  cÃ¡c method tÆ°Æ¡ng tá»±: láº¥y má»™t lÆ°á»£ng giÃ¡ trá»‹ tá»« trong RDD. take sáº½ trÆ°á»›c háº¿t scan qua má»™t partition vÃ  sá»­ dá»¥ng káº¿t quáº£ Ä‘á»ƒ dá»± Ä‘oÃ¡n sá»‘ lÆ°á»£ng partition cáº§n pháº£i láº¥y thÃªm Ä‘á»ƒ thá»a mÃ£n sá»‘ lÆ°á»£ng láº¥y.</li><li>top vÃ  takeOrdered: top sáº½ hiá»‡u quáº£ hÆ¡n takeOrdered vÃ¬ top láº¥y cÃ¡c giÃ¡ trá»‹ Ä‘áº§u tiÃªn Ä‘Æ°á»£c sáº¯p xáº¿p ngáº§m trong RDD.</li><li>takeSamples: láº¥y má»™t lÆ°á»£ng giÃ¡ trá»‹ ngáº«u nhiÃªn trong RDD</li></ul><h2 id="má»™t-sá»‘-ká»¹-thuáº­t-nÃ¢ng-cao-Ä‘á»‘i-vá»›i-rdd">Má»™t sá»‘ ká»¹ thuáº­t nÃ¢ng cao Ä‘á»‘i vá»›i RDD:</h2><h3 id="lÆ°u-trá»¯-file">LÆ°u trá»¯ file</h3><ul><li>LÆ°u trá»¯ file cÃ³ nghÄ©a lÃ  ghi vÃ o cÃ¡c file plain-text</li><li>CÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c codec nÃ©n tá»« thÆ° viá»‡n cá»§a Hadoop</li><li>LÆ°u trá»¯ vÃ o cÃ¡c database bÃªn ngoÃ i yÃªu cáº§u ta pháº£i láº·p qua táº¥t cáº£ partition cá»§a RDD - CÃ´ng viá»‡c Ä‘Æ°á»£c thá»±c hiá»‡n ngáº§m trong cÃ¡c high-level API</li><li>sequenceFile lÃ  má»™t flat file chá»©a cÃ¡c cáº·p key-value, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m Ä‘á»‹nh dáº¡ng input/output cá»§a MapReduce. Spark cÃ³ thá»ƒ ghi cÃ¡c sequenceFile báº±ng cÃ¡c ghi láº¡i cÃ¡c cáº·p key-value</li><li>Äá»“ng thá»i, Spark cÅ©ng há»— trá»£ ghi nhiá»u Ä‘á»‹nh dáº¡ng file khÃ¡c nhau, cho phÃ©p define cÃ¡c class, Ä‘á»‹nh dáº¡ng output, config vÃ  compression scheme cá»§a Hadoop.</li></ul><h3 id="caching---tÄƒng-tá»‘c-xá»­-lÃ½-báº±ng-cache">Caching - tÄƒng tá»‘c xá»­ lÃ½ báº±ng cache</h3><ul><li>Caching vá»›i RDD, Dataset hay DataFrame cÃ³ nguyÃªn lÃ½ nhÆ° nhau.</li><li>ChÃºng ta cÃ³ thá»ƒ lá»±a chá»n cache hay persist má»™t RDD, vÃ  máº·c Ä‘á»‹nh, chá»‰ xá»­ lÃ½ dá»¯ liá»‡u trong bá»™ nhá»›</li></ul><h3 id="checkpointing---lÆ°u-trá»¯-láº¡i-cÃ¡c-bÆ°á»›c-xá»­-lÃ½-Ä‘á»ƒ-phá»¥c-há»“i">Checkpointing - lÆ°u trá»¯ láº¡i cÃ¡c bÆ°á»›c xá»­ lÃ½ Ä‘á»ƒ phá»¥c há»“i</h3><ul><li>Checkpointing lÆ°u RDD vÃ o Ä‘Ä©a cá»©ng Ä‘á»ƒ cÃ¡c tiáº¿n trÃ¬nh khÃ¡c Ä‘á»ƒ thá»ƒ sá»­ dá»¥ng láº¡i RDD point nÃ y lÃ m partition trung gian thay vÃ¬ tÃ­nh toÃ¡n láº¡i RDD tá»« cÃ¡c nguá»“n dá»¯ liá»‡u gá»‘c</li><li>Checkpointing cÅ©ng tÆ°Æ¡ng tá»± nhÆ° cache, chá»‰ khÃ¡c nhau lÃ  lÆ°u trá»¯ vÃ o Ä‘Ä©a cá»©ng vÃ  khÃ´ng dÃ¹ng Ä‘Æ°á»£c trong API cá»§a DataFrame</li><li>ChÃºng ta sáº½ cáº§n sá»­ dá»¥ng nhiá»u Ä‘á»ƒ tá»‘i Æ°u tÃ­nh toÃ¡n.</li></ul></div><ul class="post__social"><li><a href="https://www.facebook.com/sharer/sharer.php?u=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="https://twitter.com/intent/tweet?&text=Spark RDD+http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://plus.google.com/share?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-google-plus"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&source=Spark RDD&summary= - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ &url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://www.stumbleupon.com/badge/?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-stumbleupon"></i></a></li><li><a href="https://www.reddit.com/submit?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li><li><a href="https://www.tumblr.com/share/link?url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-tumblr"></i></a></li><li><a href="https://www.pinterest.com/pin/create/link/?description= - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ - Khi chÃºng ta cáº§n pháº£i xá»­ lÃ½ cÃ¡c chá»©c nÄƒng khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c trong cÃ¡c API high-level Vd: cáº§n xá»­ lÃ½ dá»¯ liá»‡u á»Ÿ táº§ng váº­t lÃ½ - chá»§ Ä‘á»™ng phÃ¢n phá»‘i dá»¯ liá»‡u giá»¯a cÃ¡c cluster - Chá»‰nh sá»­a má»™t sá»‘ codebase táº§ng tháº¥p viáº¿t báº±ng RDD - Thá»±c hiá»‡n má»™t sá»‘ cÃ´ng viá»‡c yÃªu cáº§u sá»­ dá»¥ng cÃ¡c biáº¿n chia sáº» custom giá»¯a cÃ¡c cluster _Trong Ä‘a sá»‘ trÆ°á»ng há»£p, sá»­ dá»¥ng DataFrame sáº½ hiá»‡u quáº£ hÆ¡n, á»•n Ä‘á»‹nh hÆ¡n nhÆ°ng cÅ©ng tá»‘n kÃ©m hÆ¡n so vá»›i RDD_ &media=&url=http://barber.samesies.io/2019/01/05/spark-rdd/" target="_blank"><i class="fa fa-pinterest"></i></a></li></ul></div></div></article></div></main><footer class="footer section-padding"><div class="grid"><div class="subscribe" id="subscribe"><div class="subscribe__container"> <span class="subscribe__title">Subscribe</span><p class="subscribe__text">Get a weekly email of posts Iâ€™ve added to the site.</p><form method="POST" action="https://samesies.us17.list-manage.com/subscribe/post-json?u=66ddf555dab480e6a8606430b&amp;id=89b3ee034f&amp;c=?" id="mc-signup" name="mc-embedded-subscribe-form" novalidate><div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_66ddf555dab480e6a8606430b_89b3ee034f" tabindex="-1" value=""></div><div class="form-group"> <input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Email Address"></div><div class="form__btn"> <input id="mc-submit" type="submit" value="Sign Up" name="subscribe"></div></form><p class="subscribe__error hidden"></p></div></div><hr class="sep--white"/><div class="footer__container"><ul class="footer__tags"><li><a class="footer__link" href="/tag/kale">Kale</a></li><li><a class="footer__link" href="/tag/moon-drinking">Moon Drinking</a></li><li><a class="footer__link" href="/tag/squid">Squid</a></li><li><a class="footer__link" href="/tag/mixtape">Mixtape</a></li><li><a class="footer__link" href="/tag/dummy-text">Dummy Text</a></li></ul><ul class="footer__social"><li><a href="https://twitter.com/thomasvaeth" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.instagram.com/thomas.vaeth/" target="_blank"><i class="fa fa-instagram"></i></a></li><li><a href="https://www.linkedin.com/in/thomasvaeth/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://github.com/samesies" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="https://codepen.io/thomasvaeth/" target="_blank"><i class="fa fa-codepen"></i></a></li></ul></div></div></footer><section class="contact popup"><div class="popup__close"><div class="popup__exit"></div></div><div class="contact__container popup__container"><div class="contact__img"><figure class="absolute-bg" style="background-image: url(/assets/images/placeholder-28.jpg);"></figure></div><div class="contact__content"><div class="contact__mast section-padding--half"><div class="grid"><h2>Contact</h2></div></div><div class="section-padding--none"><hr class="sep"/></div><div class="contact__form section-padding--half"><div class="grid-xlarge"> <form id="form" class="form" action="https://formcarry.com/s/HkIo0nMb7" method="POST"><div class="form__subcontainer"><div> <label for="form-first-name">First Name</label> <input type="text" name="first-name" id="form-first-name" required></div><div> <label for="form-last-name">Last Name</label> <input type="text" name="last-name" id="form-last-name" required></div></div><div> <label for="form-email">E-Mail</label> <input type="email" name="email" id="form-email" required></div><div> <label for="form-message">Message</label> <textarea name="message" id="form-message" rows="3"></textarea></div><div class="form__submit"><div class="form__btn"> <input type="submit" value="Send"></div></div><p class="form__message"></p></form></div></div></div></div></section><script src="/assets/js/app.min.js"></script></body></html>
  